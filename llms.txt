# üê¢ Tidy and Explore Bioinformatic Pipeline Outputs

[![conda-latest1](https://anaconda.org/umccr/r-nemo/badges/latest_release_date.svg "Conda Latest Release")](https://anaconda.org/umccr/r-nemo)
[![gha](https://github.com/umccr/nemo/actions/workflows/deploy.yaml/badge.svg "GitHub Actions")](https://github.com/umccr/nemo/actions/workflows/deploy.yaml)

- üìö Docs: <https://umccr.github.io/nemo>
  - [Installation](https://umccr.github.io/nemo/articles/installation)
  - [R6 structure](https://umccr.github.io/nemo/articles/structure)
  - [Changelog](https://umccr.github.io/nemo/articles/NEWS)

## Overview

{nemo} is an R package that contains the building blocks for parsing,
tidying, and writing bioinformatic pipeline results in a more consistent
structure.

In short, it traverses through a directory containing results from one
or more runs of certain bioinformatic tools, parses any files it
recognises, tidies them up (which includes data reshaping,
normalisation, column name cleanup etc.), and writes them to the output
format of choice e.g.¬†Apache Parquet, PostgreSQL, TSV, RDS.

The specific tools it can handle are controlled by configuration files
written in YAML that are part of ‚Äòchild‚Äô {nemo} packages, like
{[tidywigits](https://github.com/umccr/tidywigits "tidywigits")} and
{[dracarys](https://github.com/umccr/dracarys "dracarys")}. These
configuration files (under `inst/config` in those respective packages)
specify the schemas, types, patterns and field descriptions for the
*raw* input *files* and *tidy* output *tbls*.

## üçï Installation

Using {remotes} directly from GitHub:

``` r
install.packages("remotes")
remotes::install_github("umccr/nemo") # latest main commit
remotes::install_github("umccr/nemo@v0.0.1.9002") # released version
```

Alternatively:

- conda package: <https://anaconda.org/umccr/r-nemo>

For more details see:
<https://umccr.github.io/nemo/articles/installation>

## üåÄ CLI

A `nemo.R` command line interface is available for convenience.

- If you‚Äôre using the conda package, the `nemo.R` command will already
  be available inside the activated conda environment.
- If you‚Äôre *not* using the conda package, you need to export the
  `nemo/inst/cli/` directory to your `PATH` in order to use `nemo.R`.

``` bash
nemo_cli=$(Rscript -e 'x = system.file("cli", package = "nemo"); cat(x, "\n")' | xargs)
export PATH="${nemo_cli}:${PATH}"
```

``` R
$ nemo.R --version
nemo 0.0.1.9002

#-----------------------------------#
$ nemo.R --help
usage: nemo.R [-h] [-v] {tidy,list} ...

Tidy Bioinformatic Workflows

positional arguments:
  {tidy,list}    sub-command help
    tidy         Tidy Workflow Outputs
    list         List Parsable Workflow Outputs

options:
  -h, --help     show this help message and exit
  -v, --version  show program's version number and exit
'
#-----------------------------------#
$ nemo.R tidy --help
usage: nemo.R tidy [-h] -w WORKFLOW -d IN_DIR [-o OUT_DIR] [-f FORMAT] -i ID
                   [--dbname DBNAME] [--dbuser DBUSER] [--include INCLUDE]
                   [--exclude EXCLUDE] [-q]

options:
  -h, --help            show this help message and exit
  -w WORKFLOW, --workflow WORKFLOW
                        Workflow name.
  -d IN_DIR, --in_dir IN_DIR
                        Input directory.
  -o OUT_DIR, --out_dir OUT_DIR
                        Output directory.
  -f FORMAT, --format FORMAT
                        Format of output [def: parquet] (parquet, db, tsv,
                        csv, rds)
  -i ID, --id ID        ID to use for this run.
  --dbname DBNAME       Database name.
  --dbuser DBUSER       Database user.
  --include INCLUDE     Include only these files (comma,sep).
  --exclude EXCLUDE     Exclude these files (comma,sep).
  -q, --quiet           Shush all the logs.

#-----------------------------------#
$ nemo.R list --help
usage: nemo.R list [-h] -w WORKFLOW -d IN_DIR [-f FORMAT] [-q]

options:
  -h, --help            show this help message and exit
  -w WORKFLOW, --workflow WORKFLOW
                        Workflow name.
  -d IN_DIR, --in_dir IN_DIR
                        Input directory.
  -f FORMAT, --format FORMAT
                        Format of list output [def: pretty] (tsv, pretty)
  -q, --quiet           Shush all the logs.
```

# Package index

## Base Classes

- [`Config`](https://umccr.github.io/nemo/reference/Config.md) : Config
  Object
- [`Tool`](https://umccr.github.io/nemo/reference/Tool.md) : Tool Object
- [`Workflow`](https://umccr.github.io/nemo/reference/Workflow.md) :
  Workflow Object

## Config

- [`config_prep_raw()`](https://umccr.github.io/nemo/reference/config_prep_raw.md)
  : Prepare config from raw file
- [`config_prep_raw_schema()`](https://umccr.github.io/nemo/reference/config_prep_raw_schema.md)
  : Prepare config schema from raw file
- [`config_prep_multi()`](https://umccr.github.io/nemo/reference/config_prep_multi.md)
  : Prepare config for multiple raw files
- [`config_prep_write()`](https://umccr.github.io/nemo/reference/config_prep_write.md)
  : Write config to YAML file

## Parsing

- [`parse_file()`](https://umccr.github.io/nemo/reference/parse_file.md)
  : Parse file
- [`parse_file_keyvalue()`](https://umccr.github.io/nemo/reference/parse_file_keyvalue.md)
  : Parse Key-Value file
- [`parse_file_nohead()`](https://umccr.github.io/nemo/reference/parse_file_nohead.md)
  : Parse headless file
- [`file_hdr()`](https://umccr.github.io/nemo/reference/file_hdr.md) :
  Get file header
- [`schema_guess()`](https://umccr.github.io/nemo/reference/schema_guess.md)
  : Guess Schema

## Example Classes

- [`Tool1`](https://umccr.github.io/nemo/reference/Tool1.md) : Tool1
  Object
- [`Workflow1`](https://umccr.github.io/nemo/reference/Workflow1.md) :
  Workflow1 Object

## Other

- [`empty_tbl()`](https://umccr.github.io/nemo/reference/empty_tbl.md) :
  Create Empty Tibble
- [`get_tbl_version_attr()`](https://umccr.github.io/nemo/reference/get_tbl_version_attr.md)
  : Get Table Version Attribute
- [`list_files_dir()`](https://umccr.github.io/nemo/reference/list_files_dir.md)
  : List Files
- [`nemo_metadata()`](https://umccr.github.io/nemo/reference/nemo_metadata.md)
  : Title
- [`nemo_osfx()`](https://umccr.github.io/nemo/reference/nemo_osfx.md) :
  Construct Output File Paths with Format Suffix
- [`nemo_out_formats()`](https://umccr.github.io/nemo/reference/nemo_out_formats.md)
  : Output Formats Supported
- [`nemo_write()`](https://umccr.github.io/nemo/reference/nemo_write.md)
  : Write data
- [`valid_out_fmt()`](https://umccr.github.io/nemo/reference/valid_out_fmt.md)
  : Output Format is Valid
- [`set_tbl_version_attr()`](https://umccr.github.io/nemo/reference/set_tbl_version_attr.md)
  : Set Table Version Attribute
- [`enframe_data()`](https://umccr.github.io/nemo/reference/enframe_data.md)
  : Enframe Data
- [`get_python()`](https://umccr.github.io/nemo/reference/get_python.md)
  : Get Python Binary
- [`nemo_cli()`](https://umccr.github.io/nemo/reference/nemo_cli.md) :
  Command line interface for nemo
- [`nemo_log()`](https://umccr.github.io/nemo/reference/nemo_log.md) :
  Log a message with a specified level
- [`nemo_log_date()`](https://umccr.github.io/nemo/reference/nemo_log_date.md)
  : Print current timestamp for logging
- [`nemoverse_wf_dispatch()`](https://umccr.github.io/nemo/reference/nemoverse_wf_dispatch.md)
  : Nemoverse Workflow Dispatcher
- [`pkg_found()`](https://umccr.github.io/nemo/reference/pkg_found.md) :
  Check if Package is Installed

# Articles

### All vignettes

- [Contribute](https://umccr.github.io/nemo/articles/contribute.md):
- [Devnotes](https://umccr.github.io/nemo/articles/devnotes.md):
- [Installation](https://umccr.github.io/nemo/articles/installation.md):
- [NEWS](https://umccr.github.io/nemo/articles/NEWS.md):
- [Notes](https://umccr.github.io/nemo/articles/notes.md):
- [Structure](https://umccr.github.io/nemo/articles/structure.md):
- [UML](https://umccr.github.io/nemo/articles/uml.md):
